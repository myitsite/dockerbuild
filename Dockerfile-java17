FROM kubespheredev/builder-base:v3.1.0-podman

ARG JDK_VERSION 17.0.13
ARG JDK_HOME /usr/lib/jvm/java-${JDK_VERSION}-openjdk

COPY set_java $M2

# java
ENV JAVA_VERSION $JDK_VERSION

RUN if [[ "x${JAVA_VERSION}" == x17* ]]; then \
        ARCH="" && uArch="$(uname -m)" \
        && case "${uArch##*-}" in \
            x86_64) ARCH='x64';; \
            aarch64) ARCH='aarch64';; \
            *) echo "unsupported architecture"; exit 1 ;; \
        esac \
        && echo ${ARCH} \
    else \
        yum install -y java-${JAVA_VERSION}-openjdk-devel java-${JAVA_VERSION}-openjdk-devel.i686; \
    fi
